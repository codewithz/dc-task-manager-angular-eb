<h5>Projects</h5>
<i
  class="fa fa-circle-o-notch fa-spin text-color"
  style="font-size: 35px"
  *ngIf="showLoading"
>
</i>
<div class="row">
  <div class="col-8 mx-auto">
    <div class="form-group form-row">
      <label for="drpSearchBy" class="col-form-label col-3">Search:</label>
      <div class="col-9">
        <select
          class="form-control"
          id="drpSearchBy"
          name="SearchBy"
          [(ngModel)]="searchBy"
        >
          <option value="ProjectID">Project ID</option>
          <option value="ProjectName">Project Name</option>
          <option value="DateOfStart">Date of Start</option>
          <option value="TeamSize">Team Size</option>
        </select>
      </div>
    </div>
    <div class="form-group form-row">
      <label for="textSearchText" class="col-form-label col-3">Search:</label>
      <div class="col-9">
        <div class="input-group">
          <input
            type="text"
            class="form-control"
            id="txtSearchText"
            name="SearchText"
            (keyup.enter)="onSearch()"
            [(ngModel)]="searchText"
          />
          <div class="input-group-append" (click)="onSearch()">
            <span class="input-group-text"
              ><i class="fa fa-search text-color"></i
            ></span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div class="col-8 mx-auto">
    <button
      class="btn btn-sm m-2 button-color"
      data-toggle="modal"
      data-target="#newProjectModal"
    >
      Create Project
    </button>
    <table class="table">
      <thead>
        <th>Project ID</th>
        <th>Project Name</th>
        <th>Date of Start</th>
        <th>Team Size</th>
        <th>Client Location</th>
        <th>Status</th>
        <th>Actions</th>
      </thead>
      <tbody>
        <tr
          *ngFor="let project of projects; index as i"
          [ngClass]="{
            'text-muted': !project.active
          }"
        >
          <td>{{ project.projectID }}</td>
          <td>{{ project.projectName }}</td>
          <td>{{ project.dateOfStart }}</td>
          <td>{{ project.teamSize }}</td>
          <td>{{ project.clientLocation.clientLocationName }}</td>
          <td>{{ project.status }}</td>
          <td>
            <button
              class="btn btn-sm btn-primary m-2"
              data-toggle="modal"
              data-target="#editProjectModal"
              (click)="onEditClicked($event, i)"
            >
              Edit
            </button>
            &nbsp;
            <button
              class="btn btn-sm btn-danger m-2"
              data-toggle="modal"
              data-target="#deleteProjectModal"
              (click)="onDeleteClicked(i)"
            >
              Delete
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>

<!-- Create Project  -->
<form #newProjectForm="ngForm" novalidate="novalidate">
  <div class="modal" role="dialog" id="newProjectModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title text-color">New Project</div>
          <button class="close" type="button" data-dismiss="modal">
            <span>&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <div class="form-group row">
            <label for="projectID" class="col-sm-4 form-label">
              Project ID
            </label>
            <div class="col-sm-8">
              <input
                #newProjectId="ngModel"
                type="text"
                style="width: 150px"
                placeholder="Project ID"
                name="projectId"
                id="projectId"
                class="form-control"
                [(ngModel)]="newProject.projectID"
                required="required"
                pattern="^[0-9]*$"
                [ngClass]="{
                  'is-invalid':
                    newProjectId.invalid &&
                    (newProjectId.touched ||
                      newProjectId.dirty ||
                      newProjectForm.submitted),
                  'is-valid':
                    newProjectId.valid &&
                    (newProjectId.touched ||
                      newProjectId.dirty ||
                      newProjectForm.submitted)
                }"
              />
              <span
                class="text-danger"
                *ngIf="
                  newProjectId.invalid &&
                  (newProjectId.touched ||
                    newProjectId.dirty ||
                    newProjectForm.submitted) &&
                  newProjectId.errors?.required
                "
              >
                Project ID cannot be blank</span
              >
              <span
                class="text-danger"
                *ngIf="
                  newProjectId.invalid &&
                  (newProjectId.touched ||
                    newProjectId.dirty ||
                    newProjectForm.submitted) &&
                  newProjectId.errors?.pattern
                "
              >
                Project ID can only have numbers</span
              >
            </div>
          </div>

          <div class="form-group row">
            <label for="projectName" class="col-sm-4 form-label">
              Project Name
            </label>
            <div class="col-sm-8">
              <input
                #newProjectName="ngModel"
                type="text"
                style="width: 200px"
                placeholder="Project Name"
                name="projectName"
                id="projectName"
                class="form-control"
                [(ngModel)]="newProject.projectName"
                required="required"
                minlength="3"
                maxlength="40"
                pattern="^[A-Za-z0-9 ./-]*$"
                [ngClass]="{
                  'is-invalid':
                    newProjectName.invalid &&
                    (newProjectName.touched ||
                      newProjectName.dirty ||
                      newProjectForm.submitted),
                  'is-valid':
                    newProjectName.valid &&
                    (newProjectName.touched ||
                      newProjectName.dirty ||
                      newProjectForm.submitted)
                }"
              />
              <span
                class="text-danger"
                *ngIf="
                  newProjectName.invalid &&
                  (newProjectName.touched ||
                    newProjectName.dirty ||
                    newProjectForm.submitted) &&
                  newProjectName.errors?.required
                "
              >
                Project Name cannot be blank</span
              >
              <span
                class="text-danger"
                *ngIf="
                  newProjectName.invalid &&
                  (newProjectName.touched ||
                    newProjectName.dirty ||
                    newProjectForm.submitted) &&
                  newProjectName.errors?.pattern
                "
              >
                Project Name can only have alphabets, numbers, period, hyphen,
                slash and space</span
              >
              <span
                class="text-danger"
                *ngIf="
                  newProjectName.invalid &&
                  (newProjectName.touched ||
                    newProjectName.dirty ||
                    newProjectForm.submitted) &&
                  newProjectName.errors?.minlength
                "
              >
                Project Name should of min 3 characters</span
              >
            </div>
          </div>

          <div class="form-group row">
            <label for="dateOfStart" class="col-sm-4 form-label">
              Date of Start
            </label>
            <div class="col-sm-8">
              <input
                #newDateOfStart="ngModel"
                type="date"
                style="width: 200px"
                placeholder="Date of Start"
                name="dateOfStart"
                id="dateOfStart"
                class="form-control"
                [(ngModel)]="newProject.dateOfStart"
                required="required"
                [ngClass]="{
                  'is-invalid':
                    newDateOfStart.invalid &&
                    (newDateOfStart.dirty ||
                      newDateOfStart.touched ||
                      newProjectForm.submitted),
                  'is-valid':
                    newDateOfStart.valid &&
                    (newDateOfStart.dirty ||
                      newDateOfStart.touched ||
                      newProjectForm.submitted)
                }"
              />
              <span
                class="text-danger"
                *ngIf="
                  newDateOfStart.invalid &&
                  (newDateOfStart.dirty ||
                    newDateOfStart.touched ||
                    newProjectForm.submitted) &&
                  newDateOfStart.errors?.required
                "
                >Date of Start cannot be blank</span
              >
            </div>
          </div>

          <div class="form-group row">
            <label for="teamSize" class="col-sm-4 form-label">
              Team Size
            </label>
            <div class="col-sm-8">
              <input
                #newTeamSize="ngModel"
                type="number"
                style="width: 200px"
                placeholder="Team Size"
                name="teamSize"
                id="teamSize"
                class="form-control"
                [(ngModel)]="newProject.teamSize"
                required="required"
                maxlength="7"
                pattern="^[0-9]*$"
                [ngClass]="{
                  'is-invalid':
                    newTeamSize.invalid &&
                    (newTeamSize.dirty ||
                      newTeamSize.touched ||
                      newProjectForm.submitted),
                  'is-valid':
                    newTeamSize.valid &&
                    (newTeamSize.dirty ||
                      newTeamSize.touched ||
                      newProjectForm.submitted)
                }"
              />
              <span
                class="text-danger"
                *ngIf="
                  newTeamSize.invalid &&
                  (newTeamSize.dirty ||
                    newTeamSize.touched ||
                    newProjectForm.submitted) &&
                  newTeamSize.errors?.required
                "
                >Team Size cannot be blank</span
              >
            </div>
          </div>

          <div class="form-group row">
            <label for="active" class="col-sm-4 form-label">
              Is Project Active?
            </label>
            <div class="col-sm-8">
              <div class="form-check">
                <input
                  id="checkActive"
                  type="checkbox"
                  name="checkActive"
                  class="form-check-input"
                  value="true"
                  [(ngModel)]="newProject.active"
                />
                <label for="active" class="form-check-label">Active</label>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="status" class="col-sm-4 form-label">
              Project Status
            </label>
            <div class="col-sm-8">
              <div class="form-check form-check-inline">
                <input
                  id="statusInForce"
                  type="radio"
                  name="radioStatus"
                  class="form-check-input"
                  value="In Force"
                  [(ngModel)]="newProject.status"
                />
                <label for="active" class="form-check-label">In Force</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  id="statusSupport"
                  type="radio"
                  name="radioStatus"
                  class="form-check-input"
                  value="Support"
                  [(ngModel)]="newProject.status"
                />
                <label for="active" class="form-check-label">Support</label>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="clientLocation" class="col-sm-4 form-label">
              Client Location
            </label>
            <div class="col-sm-8">
              <select
                name="clientLocation"
                id="clientLocation"
                class="form-control"
                [(ngModel)]="newProject.clientLocationID"
              >
                <option value="null">Please Select</option>
                <option
                  *ngFor="let clientLocation of clientLocations"
                  [value]="clientLocation.clientLocationID"
                >
                  {{ clientLocation.clientLocationName }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-sm m-2 button-color" data-dismiss="modal">
            Cancel
          </button>
          <button
            class="btn btn-sm m-2 button-color"
            data-dismiss="modal"
            (click)="onSave()"
          >
            Save
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
<!-- Create Project End here -->

<!-- Edit Project  -->
<form>
  <div class="modal" role="dialog" id="editProjectModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title text-color">Edit Project</div>
          <button class="close" type="button" data-dismiss="modal">
            <span>&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <div class="form-group row">
            <label for="projectID" class="col-sm-4 form-label">
              Project ID
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                style="width: 150px"
                placeholder="Project ID"
                name="projectId"
                id="projectId"
                class="form-control"
                [(ngModel)]="projectToBeEdited.projectID"
              />
            </div>
          </div>

          <div class="form-group row">
            <label for="projectName" class="col-sm-4 form-label">
              Project Name
            </label>
            <div class="col-sm-8">
              <input
                type="text"
                style="width: 200px"
                placeholder="Project Name"
                name="projectName"
                id="projectName"
                class="form-control"
                [(ngModel)]="projectToBeEdited.projectName"
              />
            </div>
          </div>

          <div class="form-group row">
            <label for="dateOfStart" class="col-sm-4 form-label">
              Date of Start
            </label>
            <div class="col-sm-8">
              <input
                type="date"
                style="width: 200px"
                placeholder="Date of Start"
                name="dateOfStart"
                id="dateOfStart"
                class="form-control"
                [(ngModel)]="projectToBeEdited.dateOfStart"
              />
            </div>
          </div>

          <div class="form-group row">
            <label for="teamSize" class="col-sm-4 form-label">
              Team Size
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                style="width: 200px"
                placeholder="Team Size"
                name="teamSize"
                id="teamSize"
                class="form-control"
                [(ngModel)]="projectToBeEdited.teamSize"
              />
            </div>
          </div>

          <div class="form-group row">
            <label for="active" class="col-sm-4 form-label">
              Is Project Active?
            </label>
            <div class="col-sm-8">
              <div class="form-check">
                <input
                  id="checkActive"
                  type="checkbox"
                  name="checkActive"
                  class="form-check-input"
                  value="true"
                  [(ngModel)]="projectToBeEdited.active"
                />
                <label for="active" class="form-check-label">Active</label>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="status" class="col-sm-4 form-label">
              Project Status
            </label>
            <div class="col-sm-8">
              <div class="form-check form-check-inline">
                <input
                  id="statusInForce"
                  type="radio"
                  name="radioStatus"
                  class="form-check-input"
                  value="In Force"
                  [(ngModel)]="projectToBeEdited.status"
                />
                <label for="active" class="form-check-label">In Force</label>
              </div>
              <div class="form-check form-check-inline">
                <input
                  id="statusSupport"
                  type="radio"
                  name="radioStatus"
                  class="form-check-input"
                  value="Support"
                  [(ngModel)]="projectToBeEdited.status"
                />
                <label for="active" class="form-check-label">Support</label>
              </div>
            </div>
          </div>

          <div class="form-group row">
            <label for="clientLocation" class="col-sm-4 form-label">
              Client Location
            </label>
            <div class="col-sm-8">
              <select
                name="clientLocation"
                id="clientLocation"
                class="form-control"
                [(ngModel)]="projectToBeEdited.clientLocationID"
              >
                <option value="null">Please Select</option>
                <option
                  *ngFor="let clientLocation of clientLocations"
                  [value]="clientLocation.clientLocationID"
                >
                  {{ clientLocation.clientLocationName }}
                </option>
              </select>
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-sm m-2 button-color" data-dismiss="modal">
            Cancel
          </button>
          <button
            class="btn btn-sm m-2 button-color"
            data-dismiss="modal"
            (click)="onUpdate()"
          >
            Update
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
<!-- Edit Project End here -->

<!-- Delete Project  -->
<form>
  <div class="modal" role="dialog" id="deleteProjectModal">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <div class="modal-title text-color">
            Are you sure, you want to delete this project?
          </div>
          <button class="close" type="button" data-dismiss="modal">
            <span>&times;</span>
          </button>
        </div>

        <div class="modal-body">
          <div class="form-group row">
            <label for="projectID" class="col-sm-4 form-label">
              Project ID
            </label>
            <div class="col-sm-8">
              <input
                type="number"
                style="width: 150px"
                placeholder="Project ID"
                name="projectId"
                id="projectId"
                class="form-control"
                [(ngModel)]="projectToBeDeleted.projectID"
              />
            </div>
          </div>

          <div class="form-group row">
            <label for="projectName" class="col-sm-4 form-label">
              Project Name
            </label>
            <div class="col-sm-8">
              <input
                type="text"
                style="width: 200px"
                placeholder="Project Name"
                name="projectName"
                id="projectName"
                class="form-control"
                [(ngModel)]="projectToBeDeleted.projectName"
              />
            </div>
          </div>
        </div>

        <div class="modal-footer">
          <button class="btn btn-sm m-2 button-color" data-dismiss="modal">
            Cancel
          </button>
          <button
            class="btn btn-sm m-2 btn-danger"
            data-dismiss="modal"
            (click)="onDeleteConfirmed()"
          >
            Delete
          </button>
        </div>
      </div>
    </div>
  </div>
</form>
<!-- Delete Project End here -->
